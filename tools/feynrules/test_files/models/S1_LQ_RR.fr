(*--------------------------------------------------------------*)
(* Model:    Scalar Leptoquark S1 add-on to SM                  *)
(* Purpose:  QCD pair production + Yukawa decay S -> e u        *)
(* Notes:    Keeps full QCD and (optionally) hypercharge.       *)
(*           Yukawa written phenomenologically (first gen).     *)
(*           Good for MG5: pp > S1 S1~ , S1 > e- u , etc.       *)
(*--------------------------------------------------------------*)

M$ModelName = "S1_LQ_RR";
(*First-generation-philic Scalar leptoquark S1 ~ (3, 1, -1/3)*)

(* ************************** *)
(* *****  Information   ***** *)
(* ************************** *)

M$Information = {
  Authors      -> "Tony Menzo",
  Version      -> "1.0.0",
  Date         -> "11.11.2025",
  Institutions -> {"University of Alabama", "Fermilab"},
  Emails       -> "amenzo@ua.edu"
};

M$InteractionOrderHierarchy = {
  {NP, 2}
};

(******************************************)
(******************************************)
(*               Parameters               *)
(******************************************)
(******************************************)


M$Parameters = {

  (* S1 leptoquark mass *)
  (*MS1 == {
      ParameterType -> External,
      BlockName     -> BSMINPUTS,
      Value         -> 1500.0,
      Description   -> "S1 mass"
  },*)

  (* Real Yukawa for S1 -> e u *)
  yRR11 == {
      ParameterType -> External,
      Blockname -> BSMINPUTS, 
      ComplexParameter -> False,
      InteractionOrder -> {NP, 1},
      Value -> 0.5,
      Description -> "S1-e-u Yukawa"
    }
};

(******************************************)
(******************************************)
(*            Field Definitions           *)
(******************************************)
(******************************************)

M$ClassesDescription = {

(******************************************)
(* Scalar singlet S1^\dagger = (3,1,-1/3) *)
(******************************************)

S[100] == {
    ClassName        -> S1,
    Mass             -> {MS1, 1500.},
    Width            -> {W1, Automatic},
    SelfConjugate    -> False,
    PropagatorLabel  -> "S1",
    PropagatorType   -> ScalarDash,
    PropagatorArrow  -> None,
    QuantumNumbers   -> {Q -> -1/3},
    Indices          -> {Index[Colour]},
    ParticleName     -> "S1",
    AntiParticleName -> "S1~",
    FullName         -> "Scalar leptoquark S1"
}

};

(******************************************)
(******************************************)
(*              Lagrangians               *)
(******************************************)
(******************************************)

(* Kinetic + mass terms (use SM gauge groups already loaded). *)
LkinS1 = Block[{mu,aa},
  ExpandIndices[
    (*HC[DC[S1, mu]] . DC[S1, mu]*) 
    DC[S1bar[aa],mu] DC[S1[aa],mu] - MS1^2 * HC[S1].S1
    ]
];

(* Yukawa coupling to e u (first generation). *)
L1YukRRNonHC := Block[{sp, aa},
  yRR11 * anti[CC[uR]][sp, 1, aa].lR[sp, 1] * HC[S1][aa]
];

(* Add Hermitian conjugate. *)
L1YukRR := L1YukRRNonHC + HC[L1YukRRNonHC];

(* Full BSM Lagrangian. *)
LBSM = LkinS1 + L1YukRR;